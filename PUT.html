<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Редактирование заявки</title>
</head>
<body>
    <div>
        <a href="GET.html">Получить заявки</a>
        <a href="POST.html">Добавить заявку</a>
        <a href="PUT.html">Редактировать заявку</a>
    </div>

    <form id="edit-order-form">
        <label for="number">Номер заявки:</label>
        <input type="number" id="number" name="number" required><br><br>

        <label for="check_in">Дата заезда:</label>
        <input type="date" id="check_in" name="check_in"><br><br>

        <label for="departure">Дата выезда:</label>
        <input type="date" id="departure" name="departure"><br><br>

        <label for="wishes">Пожелания:</label>
        <textarea id="wishes" name="wishes"></textarea><br><br>

        <input type="submit" value="Редактировать заявку">
    </form>

    <script>
        const editOrderForm = document.getElementById('edit-order-form');

        editOrderForm.addEventListener('submit', async (event) => {
            event.preventDefault();

            const number = document.getElementById('number').value;
            const checkIn = document.getElementById('check_in').value;
            const departure = document.getElementById('departure').value;
            const wishes = document.getElementById('wishes').value;

            const updatedOrder = {
                check_in: checkIn,
                departure: departure,
                wishes: wishes
            };

            try {
                const response = await fetch(`http://localhost:7777/ord/${number}`, {
                    method: "PUT",
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(updatedOrder)
                });

                if (response.ok) {
                    alert("Заявка успешно отредактирована!");
                    window.location.href = "GET.html"; // Перенаправление на GET.html
                } else {
                    console.error("Ошибка при редактировании заявки:", response.status);
                    alert("Ошибка при редактировании заявки!");
                }
            } catch (error) {
                console.error("Ошибка:", error);
                alert("Ошибка при редактировании заявки!");
            }
        });
    </script>
</body>
</html>